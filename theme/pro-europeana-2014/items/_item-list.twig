{#
  used in:
  	- listing.twig
#}

{% if (record) %}

{% set listItem = record %}
{% set contenttype = record.contenttype.name %}
{% set authors = listItem.related('persons') %}
{% set location = record.related('locations')|first %}

	<li class="list-item">

		<div class="item-supplementary">
		{% if (contenttype == "Publications" or contenttype == "BlogPosts") %}
			<div class="item-image">
				<a href="{{ listItem.link }}"><img src="{{ listItem.image|thumbnail() }}" alt="{{ listItem.values['image'].title }}" /></a>
			</div>
		{% elseif contenttype == "Events" %}
			<div class="item-bigdate">
				{% include 'items/_item-date-event.twig' with {record : listItem} %}
			</div>
		{% endif %}

		</div><!--

	 --><div class="item-details">
		{% if contenttype == 'Structures' %}
			<h2 class="title"><a href="{{path.root}}{{ listItem.slug }}">{{ listItem.title }}</a></h2>
		{% elseif contenttype == 'Pages' %}
			<h2 class="title"><a href="{{path.root}}{{ listItem.group.slug }}/{{ listItem.slug }}">{{ listItem.title }}</a></h2>
		{% else %}
			<h2 class="title"><a href="{{ listItem.link }}">{{ listItem.title }}</a></h2>
		{% endif %}

		{% if contenttype == "Publications" %}
			{# set authors #}
			{% include 'items/_item-author.twig' with {records : authors} %}
		{% elseif contenttype == "BlogPosts" %}
			{# set author #}
			{% include 'items/_item-author.twig' with {records : authors} %}

			{# set readtime #}
			{#  todo: where did that came from? -> update contenttype "blogpost" #}
			{% include 'items/_item-readtime.twig' %}
		{% endif %}

			<div class="item-meta-secondary">

			{% if contenttype == "Publications" %}
				{# set date #}
				{% include 'items/_item-date.twig' %}
				{# set tags#}
				{% include 'items/_item-tags.twig' %}
			{% elseif contenttype == "BlogPosts" %}
				{# set date #}
				{% include 'items/_item-date.twig' %}
				{# set tags #}
				{% include 'items/_item-tags.twig' %}
				{# set discus comments #}
				{% include 'items/_item-comments-link.twig' %}

			{% elseif contenttype == "Events" %}
				{# set location #}
				{% include 'items/_item-location.twig' with {record: location} %}
				{# set tags #}
				{% include 'items/_item-tags.twig' %}
			{% elseif contenttype == "Jobs" %}
				{# set date #}
				{% include 'items/_item-date.twig' %}
				{# set location #}
				{% include 'items/_item-location.twig' with {record: location} %}
				{# set department #}
				{% include 'items/_item-department.twig' %}
			{% endif %}

			</div>

			<div class="item-preview">
                {# addition by Bob: the old, imported blogpostings have no teaser. In this case we use an
                   excerpt from the body instead. #}
                {% if listItem.teaser|length > 10 %}
				    {{ listItem.teaser }}
                {% else %}
                    {{ listItem.body|excerpt(250) }}
                {% endif %}
			</div>

			{% if contenttype == "Publications" %}
				{% include 'items/_item-filelist.twig' with {records: listItem.filelist} %}
			{% endif %}


		</div>

	</li>
{% endif %}

